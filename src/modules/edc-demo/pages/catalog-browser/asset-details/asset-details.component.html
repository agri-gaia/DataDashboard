<div fxLayout="column" style="height: 100%">
  <div fxLayout="row" fxLayoutAlign="space-between center" class="header">
    <h1>{{contractOffer.asset.name}}</h1>
    <button mat-icon-button (click)="this.dialog.close()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div fxLayout="column">
    <h2>Asset Details</h2>
  </div>
  <mat-list dense class="list" fxLayout="row wrap">
    <mat-list-item>
      <mat-icon mat-list-icon>fingerprint</mat-icon>
      <div class="asset-property-name" mat-line>Id</div>
      <div mat-line>{{contractOffer.asset.id}}</div>
    </mat-list-item>
    <mat-list-item>
      <mat-icon mat-list-icon>description</mat-icon>
      <div class="asset-property-name" mat-line>Beschreibung</div>
      <div mat-line>{{contractOffer.asset.description}}</div>
    </mat-list-item>
    <mat-list-item>
      <mat-icon mat-list-icon>numbers</mat-icon>
      <div class="asset-property-name" mat-line>Version</div>
      <div mat-line>{{contractOffer.asset.version}}</div>
    </mat-list-item>
    <mat-list-item *ngIf="contractOffer.asset.contentType">
      <mat-icon mat-list-icon>content_paste</mat-icon>
      <div class="asset-property-name" mat-line>Content-Type</div>
      <div mat-line>{{contractOffer.asset.contentType}}</div>
    </mat-list-item>

    <mat-list-item *ngIf="contractOffer.asset.originator">
      <mat-icon mat-list-icon>link</mat-icon>
      <div class="asset-property-name" mat-line>Originator</div>
      <div mat-line>{{contractOffer.asset.originator}}</div>
    </mat-list-item>


    <mat-list-item *ngFor="let additionalPropertyKey of contractOffer.asset.additionalPropertyKeys">
      <mat-icon *ngIf="additionalPropertyKey.replace('asset:prop:', '') as name" mat-list-icon>{{getPropertyIcon(name)}}</mat-icon>
      <div *ngIf="additionalPropertyKey.replace('asset:prop:', '') as name"
           class="asset-property-name"
           mat-line>
        {{ parsePropertyName(name)}}
      </div>
      <div mat-line title="{{contractOffer.asset.properties[additionalPropertyKey]}}">
        {{contractOffer.asset.properties[additionalPropertyKey]}}</div>
    </mat-list-item>
  </mat-list>
  <mat-divider class="divider"></mat-divider>
  <div fxLayout="column">
    <h2>Policy Details</h2>
  </div>

  <mat-list dense class="list" fxLayout="row wrap">
    <mat-list-item>
      <mat-icon mat-list-icon>policy</mat-icon>
      <div mat-line class="asset-property-name">Policy ID</div>
      <div mat-line>{{contractOffer.asset.policyId}}</div>
    </mat-list-item>
    <mat-list-item>
      <mat-icon mat-list-icon>category</mat-icon>
      <div class="asset-property-name" mat-line>Target</div>
      <div mat-line>{{contractOffer.policy.target}}</div>
    </mat-list-item>
    <mat-list-item>
      <mat-icon mat-list-icon>key</mat-icon>
      <div class="asset-property-name" mat-line>Verpflichtungen</div>
      <div mat-line>{{contractOffer.policy.obligations}}</div>
    </mat-list-item>
    <mat-list-item>
      <mat-icon mat-list-icon>numbers</mat-icon>
      <div class="asset-property-name" mat-line>Permissions</div>
      <div mat-line *ngFor="let permission of contractOffer.policy!.permissions!">{{permission.uid}}</div>
    </mat-list-item>
  </mat-list>

  <div class="footer" fxLayout="column">
    <div fxFlex fxLayoutAlign="end">
      <button (click)="onNegotiateClicked(contractOffer)"
              *ngIf="!runningNegotiation"
              [disabled]="!contractOffer.asset.isAsync || isBusy(contractOffer) || isNegotiated(contractOffer)"
              color="primary" mat-raised-button
              class="footer-button"
      >
        Kaufen
      </button>
      <mat-progress-bar mode="indeterminate" *ngIf="runningNegotiation" [ngStyle]="runningNegotiation?{'color':'white'} : {}"></mat-progress-bar>
    </div>

  </div>

</div>

